FROM python:3.9-slim

# 安裝基本依賴和 whisper
RUN apt-get update && apt-get install -y --no-install-recommends \
    curl ca-certificates ffmpeg wget unzip && \
    pip3 install --no-cache-dir fastapi "uvicorn[standard]" python-multipart requests openai-whisper && \
    rm -rf /var/lib/apt/lists/*

WORKDIR /app
COPY server.py /app/server.py
RUN mkdir -p /models /data

EXPOSE 8000
CMD ["uvicorn", "server:app", "--host", "0.0.0.0", "--port", "8000"]